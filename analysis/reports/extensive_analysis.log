Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
def to_organization_map(flat_organization_dataframe: pd.DataFrame):
    return {
        organization_name: proposal_df
        for organization_name, proposal_df in [
            (str(organization_name), space_proposals)
            for organization_name, space_proposals in flat_organization_dataframe.groupby(
                "proposal_organization_name"
            )
        ]
    }

plutocracy_report_data = to_organization_map(all_organization_proposals)
plutocracy_report_data_filtered = to_organization_map(all_organization_proposals_filtered)

------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mKeyError[0m                                  Traceback (most recent call last)
Cell [0;32mIn[3], line 12[0m
[1;32m      1[0m [38;5;28;01mdef[39;00m [38;5;21mto_organization_map[39m(flat_organization_dataframe: pd[38;5;241m.[39mDataFrame):
[1;32m      2[0m     [38;5;28;01mreturn[39;00m {
[1;32m      3[0m         organization_name: proposal_df
[1;32m      4[0m         [38;5;28;01mfor[39;00m organization_name, proposal_df [38;5;129;01min[39;00m [
[0;32m   (...)[0m
[1;32m      9[0m         ]
[1;32m     10[0m     }
[0;32m---> 12[0m plutocracy_report_data [38;5;241m=[39m [43mto_organization_map[49m[43m([49m[43mall_organization_proposals[49m[43m)[49m
[1;32m     13[0m plutocracy_report_data_filtered [38;5;241m=[39m to_organization_map(all_organization_proposals_filtered)

Cell [0;32mIn[3], line 6[0m, in [0;36mto_organization_map[0;34m(flat_organization_dataframe)[0m
[1;32m      1[0m [38;5;28;01mdef[39;00m [38;5;21mto_organization_map[39m(flat_organization_dataframe: pd[38;5;241m.[39mDataFrame):
[1;32m      2[0m     [38;5;28;01mreturn[39;00m {
[1;32m      3[0m         organization_name: proposal_df
[1;32m      4[0m         [38;5;28;01mfor[39;00m organization_name, proposal_df [38;5;129;01min[39;00m [
[1;32m      5[0m             ([38;5;28mstr[39m(organization_name), space_proposals)
[0;32m----> 6[0m             [38;5;28;01mfor[39;00m organization_name, space_proposals [38;5;129;01min[39;00m [43mflat_organization_dataframe[49m[38;5;241;43m.[39;49m[43mgroupby[49m[43m([49m
[1;32m      7[0m [43m                [49m[38;5;124;43m"[39;49m[38;5;124;43mproposal_organization_name[39;49m[38;5;124;43m"[39;49m
[1;32m      8[0m [43m            [49m[43m)[49m
[1;32m      9[0m         ]
[1;32m     10[0m     }

File [0;32m/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/pandas/core/frame.py:8399[0m, in [0;36mDataFrame.groupby[0;34m(self, by, axis, level, as_index, sort, group_keys, squeeze, observed, dropna)[0m
[1;32m   8396[0m     [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([38;5;124m"[39m[38;5;124mYou have to supply one of [39m[38;5;124m'[39m[38;5;124mby[39m[38;5;124m'[39m[38;5;124m and [39m[38;5;124m'[39m[38;5;124mlevel[39m[38;5;124m'[39m[38;5;124m"[39m)
[1;32m   8397[0m axis [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_axis_number(axis)
[0;32m-> 8399[0m [38;5;28;01mreturn[39;00m [43mDataFrameGroupBy[49m[43m([49m
[1;32m   8400[0m [43m    [49m[43mobj[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m   8401[0m [43m    [49m[43mkeys[49m[38;5;241;43m=[39;49m[43mby[49m[43m,[49m
[1;32m   8402[0m [43m    [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m   8403[0m [43m    [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m   8404[0m [43m    [49m[43mas_index[49m[38;5;241;43m=[39;49m[43mas_index[49m[43m,[49m
[1;32m   8405[0m [43m    [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m   8406[0m [43m    [49m[43mgroup_keys[49m[38;5;241;43m=[39;49m[43mgroup_keys[49m[43m,[49m
[1;32m   8407[0m [43m    [49m[43msqueeze[49m[38;5;241;43m=[39;49m[43msqueeze[49m[43m,[49m
[1;32m   8408[0m [43m    [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m   8409[0m [43m    [49m[43mdropna[49m[38;5;241;43m=[39;49m[43mdropna[49m[43m,[49m
[1;32m   8410[0m [43m[49m[43m)[49m

File [0;32m/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/pandas/core/groupby/groupby.py:959[0m, in [0;36mGroupBy.__init__[0;34m(self, obj, keys, axis, level, grouper, exclusions, selection, as_index, sort, group_keys, squeeze, observed, mutated, dropna)[0m
[1;32m    956[0m [38;5;28;01mif[39;00m grouper [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[1;32m    957[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mpandas[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcore[39;00m[38;5;21;01m.[39;00m[38;5;21;01mgroupby[39;00m[38;5;21;01m.[39;00m[38;5;21;01mgrouper[39;00m [38;5;28;01mimport[39;00m get_grouper
[0;32m--> 959[0m     grouper, exclusions, obj [38;5;241m=[39m [43mget_grouper[49m[43m([49m
[1;32m    960[0m [43m        [49m[43mobj[49m[43m,[49m
[1;32m    961[0m [43m        [49m[43mkeys[49m[43m,[49m
[1;32m    962[0m [43m        [49m[43maxis[49m[38;5;241;43m=[39;49m[43maxis[49m[43m,[49m
[1;32m    963[0m [43m        [49m[43mlevel[49m[38;5;241;43m=[39;49m[43mlevel[49m[43m,[49m
[1;32m    964[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[1;32m    965[0m [43m        [49m[43mobserved[49m[38;5;241;43m=[39;49m[43mobserved[49m[43m,[49m
[1;32m    966[0m [43m        [49m[43mmutated[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmutated[49m[43m,[49m
[1;32m    967[0m [43m        [49m[43mdropna[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdropna[49m[43m,[49m
[1;32m    968[0m [43m    [49m[43m)[49m
[1;32m    970[0m [38;5;28mself[39m[38;5;241m.[39mobj [38;5;241m=[39m obj
[1;32m    971[0m [38;5;28mself[39m[38;5;241m.[39maxis [38;5;241m=[39m obj[38;5;241m.[39m_get_axis_number(axis)

File [0;32m/opt/hostedtoolcache/Python/3.10.11/x64/lib/python3.10/site-packages/pandas/core/groupby/grouper.py:888[0m, in [0;36mget_grouper[0;34m(obj, key, axis, level, sort, observed, mutated, validate, dropna)[0m
[1;32m    886[0m         in_axis, level, gpr [38;5;241m=[39m [38;5;28;01mFalse[39;00m, gpr, [38;5;28;01mNone[39;00m
[1;32m    887[0m     [38;5;28;01melse[39;00m:
[0;32m--> 888[0m         [38;5;28;01mraise[39;00m [38;5;167;01mKeyError[39;00m(gpr)
[1;32m    889[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(gpr, Grouper) [38;5;129;01mand[39;00m gpr[38;5;241m.[39mkey [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m    890[0m     [38;5;66;03m# Add key to exclusions[39;00m
[1;32m    891[0m     exclusions[38;5;241m.[39madd(gpr[38;5;241m.[39mkey)

[0;31mKeyError[0m: 'proposal_organization_name'
KeyError: 'proposal_organization_name'

